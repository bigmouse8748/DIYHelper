# DIY Smart Assistant - æ™ºèƒ½DIYåŠ©æ‰‹å¹³å°

## ğŸ¯ é¡¹ç›®æ„¿æ™¯

æ‰“é€ ä¸€ä¸ªç°ä»£åŒ–çš„æ™ºèƒ½DIYåŠ©æ‰‹å¹³å°ï¼Œä¸ºç”¨æˆ·æä¾›AIé©±åŠ¨çš„é¡¹ç›®åˆ†æã€å·¥å…·è¯†åˆ«å’Œè´­ç‰©å»ºè®®æœåŠ¡ã€‚é€šè¿‡å…ˆè¿›çš„æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œå¸®åŠ©DIYçˆ±å¥½è€…æ›´å¥½åœ°è§„åˆ’å’Œå®Œæˆé¡¹ç›®ã€‚

### æ ¸å¿ƒä»·å€¼ä¸»å¼ 
- **æ™ºèƒ½åˆ†æ**: ä½¿ç”¨AIæŠ€æœ¯åˆ†æç”¨æˆ·ä¸Šä¼ çš„é¡¹ç›®å›¾ç‰‡ï¼Œæä¾›ä¸“ä¸šçš„DIYæŒ‡å¯¼
- **å·¥å…·è¯†åˆ«**: é€šè¿‡å›¾åƒè¯†åˆ«æŠ€æœ¯ï¼Œå¸®åŠ©ç”¨æˆ·è¯†åˆ«å·¥å…·å¹¶æä¾›è´­ä¹°å»ºè®®
- **ä¸ªæ€§åŒ–æ¨è**: åŸºäºç”¨æˆ·åå¥½å’Œé¡¹ç›®éœ€æ±‚ï¼Œæä¾›ç²¾å‡†çš„äº§å“æ¨è
- **å¤šçº§æœåŠ¡**: æä¾›ä»å…è´¹åˆ°ä¸“ä¸šç‰ˆçš„å¤šå±‚æ¬¡æœåŠ¡

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„åŸåˆ™
- **å¾®æœåŠ¡æ€æƒ³**: æ¨¡å—åŒ–è®¾è®¡ï¼ŒèŒè´£åˆ†ç¦»
- **APIä¼˜å…ˆ**: RESTful APIè®¾è®¡ï¼Œå‰åç«¯åˆ†ç¦»
- **å¯æ‰©å±•æ€§**: æ”¯æŒæ°´å¹³æ‰©å±•å’ŒåŠŸèƒ½æ‰©å±•
- **å®‰å…¨æ€§**: å®Œå–„çš„è®¤è¯æˆæƒå’Œæ•°æ®ä¿æŠ¤
- **ç”¨æˆ·ä½“éªŒ**: å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå¤šè®¾å¤‡è®¿é—®

### æŠ€æœ¯æ ˆé€‰æ‹©

#### **å‰ç«¯æŠ€æœ¯æ ˆ**
```typescript
// æ ¸å¿ƒæ¡†æ¶
Vue 3 + TypeScript + Composition API

// UIæ¡†æ¶
Element Plus (ç»„ä»¶ä¸°å¯Œï¼Œæ–‡æ¡£å®Œå–„)

// çŠ¶æ€ç®¡ç†
Pinia (Vue 3å®˜æ–¹æ¨èï¼Œç®€å•æ˜“ç”¨)

// è·¯ç”±
Vue Router 4

// æ„å»ºå·¥å…·
Vite (å¿«é€Ÿæ„å»ºï¼Œçƒ­æ›´æ–°)

// å›½é™…åŒ–
Vue I18n (æ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢)

// HTTPå®¢æˆ·ç«¯
Axios (æ‹¦æˆªå™¨ï¼Œè¯·æ±‚å“åº”å¤„ç†)

// å·¥å…·åº“
Day.js (æ—¥æœŸå¤„ç†)
Lodash (å·¥å…·å‡½æ•°)
```

#### **åç«¯æŠ€æœ¯æ ˆ**
```python
# Webæ¡†æ¶
FastAPI (é«˜æ€§èƒ½ï¼Œè‡ªåŠ¨APIæ–‡æ¡£ï¼Œç±»å‹æç¤º)

# æ•°æ®åº“ORM
SQLAlchemy (åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå¤šæ•°æ®åº“)

# æ•°æ®åº“
PostgreSQL (ç”Ÿäº§) / SQLite (å¼€å‘)

# è®¤è¯ç³»ç»Ÿ - æ··åˆæœ¬åœ°è®¤è¯
JWT (æ— çŠ¶æ€ï¼Œé€‚åˆåˆ†å¸ƒå¼ï¼Œ15-30åˆ†é’Ÿè¿‡æœŸ)
bcrypt (å®‰å…¨å¯†ç å“ˆå¸Œ)
Refresh Token (7å¤©è¿‡æœŸï¼Œå¯æ’¤é”€)
Tokené»‘åå•æœºåˆ¶ (Rediså­˜å‚¨)
é‚®ç®±éªŒè¯å’Œå¯†ç é‡ç½®

# AIæœåŠ¡
OpenAI GPT-4 Vision API (å›¾åƒåˆ†æ)

# æ–‡ä»¶å¤„ç†
Pillow (å›¾åƒå¤„ç†)
python-multipart (æ–‡ä»¶ä¸Šä¼ )

# æ•°æ®éªŒè¯
Pydantic (ç±»å‹éªŒè¯ï¼Œæ•°æ®åºåˆ—åŒ–)

# å¼‚æ­¥æ”¯æŒ
asyncio + httpx (å¼‚æ­¥HTTPè°ƒç”¨)

# ä»»åŠ¡é˜Ÿåˆ—
Celery + Redis (åå°ä»»åŠ¡å¤„ç†)
```

---

## ğŸ“Š ç³»ç»Ÿè®¾è®¡

### æ•°æ®åº“è®¾è®¡

#### **ç”¨æˆ·ç³»ç»Ÿ**
```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100),
    avatar_url VARCHAR(500),
    user_type user_type_enum DEFAULT 'free',
    preferences JSONB DEFAULT '{}',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP,
    is_active BOOLEAN DEFAULT TRUE,
    email_verified BOOLEAN DEFAULT FALSE,
    phone VARCHAR(20),
    location VARCHAR(100)
);

-- ç”¨æˆ·ç±»å‹æšä¸¾
CREATE TYPE user_type_enum AS ENUM ('free', 'pro', 'premium', 'admin');

-- ç”¨æˆ·ä¼šè¯è¡¨ (JWTé»‘åå•)
CREATE TABLE user_sessions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    jti VARCHAR(36) UNIQUE NOT NULL,  -- JWT ID
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP NOT NULL,
    is_revoked BOOLEAN DEFAULT FALSE
);
```

#### **äº§å“ç³»ç»Ÿ**
```sql
-- äº§å“è¡¨
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    category product_category_enum NOT NULL,
    subcategory VARCHAR(100),
    brand VARCHAR(100),
    model VARCHAR(100),
    sku VARCHAR(100),
    
    -- ä»·æ ¼ä¿¡æ¯
    original_price DECIMAL(10,2),
    sale_price DECIMAL(10,2),
    discount_percentage INTEGER,
    currency VARCHAR(3) DEFAULT 'USD',
    
    -- å•†å®¶ä¿¡æ¯
    merchant merchant_enum NOT NULL,
    merchant_product_id VARCHAR(100),
    product_url VARCHAR(500) NOT NULL,
    
    -- åª’ä½“èµ„æº
    images JSONB DEFAULT '[]',  -- [{"url": "", "alt": "", "type": "main|gallery"}]
    videos JSONB DEFAULT '[]',
    
    -- è§„æ ¼å‚æ•°
    specifications JSONB DEFAULT '{}',
    dimensions JSONB DEFAULT '{}',  -- {"length": 10, "width": 5, "height": 3, "weight": 2}
    
    -- è¯„ä»·ä¿¡æ¯
    rating DECIMAL(3,2),
    rating_count INTEGER DEFAULT 0,
    reviews_summary JSONB DEFAULT '{}',
    
    -- æ ‡ç­¾å’Œåˆ†ç±»
    tags JSONB DEFAULT '[]',
    project_types JSONB DEFAULT '[]',
    difficulty_levels JSONB DEFAULT '[]',  -- ["beginner", "intermediate", "advanced"]
    
    -- çŠ¶æ€ç®¡ç†
    is_featured BOOLEAN DEFAULT FALSE,
    is_active BOOLEAN DEFAULT TRUE,
    availability_status availability_enum DEFAULT 'in_stock',
    sort_order INTEGER DEFAULT 0,
    
    -- ç»Ÿè®¡ä¿¡æ¯
    view_count INTEGER DEFAULT 0,
    click_count INTEGER DEFAULT 0,
    purchase_count INTEGER DEFAULT 0,
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_checked TIMESTAMP,
    
    -- åˆ›å»ºè€…
    created_by INTEGER REFERENCES users(id)
);

-- äº§å“åˆ†ç±»æšä¸¾
CREATE TYPE product_category_enum AS ENUM (
    'power_tools', 'hand_tools', 'materials', 'hardware', 
    'safety_equipment', 'measuring_tools', 'automotive', 
    'electrical', 'plumbing', 'woodworking', 'metalworking'
);

-- å•†å®¶æšä¸¾
CREATE TYPE merchant_enum AS ENUM (
    'amazon', 'home_depot', 'lowes', 'harbor_freight',
    'menards', 'ace_hardware', 'walmart', 'target'
);

-- å¯ç”¨æ€§æšä¸¾
CREATE TYPE availability_enum AS ENUM (
    'in_stock', 'low_stock', 'out_of_stock', 'discontinued'
);
```

#### **AIæœåŠ¡ç³»ç»Ÿ**
```sql
-- å·¥å…·è¯†åˆ«è®°å½•
CREATE TABLE tool_identifications (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE SET NULL,
    
    -- è¾“å…¥ä¿¡æ¯
    original_filename VARCHAR(255),
    image_path VARCHAR(500) NOT NULL,
    image_hash VARCHAR(64),  -- é˜²æ­¢é‡å¤è¯†åˆ«
    file_size INTEGER,
    image_dimensions JSONB,  -- {"width": 1920, "height": 1080}
    
    -- AIè¯†åˆ«ç»“æœ
    identification_result JSONB NOT NULL,
    -- {
    --   "primary": {"name": "DeWalt Circular Saw", "model": "DWE575", "confidence": 0.95},
    --   "alternatives": [{"name": "...", "confidence": 0.85}],
    --   "category": "power_tools",
    --   "features": ["cordless", "7.25_inch_blade"]
    -- }
    
    -- æ¨èäº§å“
    recommended_products JSONB DEFAULT '[]',  -- äº§å“IDæ•°ç»„
    
    -- å¤„ç†ä¿¡æ¯
    processing_time DECIMAL(5,3),  -- å¤„ç†æ—¶é—´(ç§’)
    ai_model_version VARCHAR(50),
    confidence_score DECIMAL(3,2),
    
    -- ç”¨æˆ·åé¦ˆ
    user_feedback JSONB DEFAULT '{}',  -- {"helpful": true, "rating": 5, "comment": ""}
    
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- DIYé¡¹ç›®åˆ†æè®°å½•
CREATE TABLE project_analyses (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE SET NULL,
    
    -- é¡¹ç›®è¾“å…¥
    project_name VARCHAR(200),
    description TEXT,
    images JSONB NOT NULL,  -- [{"path": "", "filename": "", "role": "main|detail|reference"}]
    project_type VARCHAR(50),
    budget_range budget_range_enum,
    skill_level skill_level_enum,
    timeline VARCHAR(50),  -- "weekend", "week", "month"
    
    -- AIåˆ†æç»“æœ
    analysis_result JSONB NOT NULL,
    -- {
    --   "project_overview": {"name": "...", "description": "...", "difficulty": "intermediate"},
    --   "materials": [{"item": "2x4 lumber", "quantity": "10 pieces", "estimated_cost": 25.99}],
    --   "tools_required": [{"tool": "circular_saw", "essential": true, "alternatives": []}],
    --   "steps": [{"step": 1, "title": "...", "description": "...", "time": "30min"}],
    --   "safety_notes": ["wear safety glasses", "use dust mask"],
    --   "tips": ["measure twice cut once", "pre-drill holes"],
    --   "estimated_total_cost": {"min": 150, "max": 250},
    --   "estimated_time": {"min": "4 hours", "max": "8 hours"}
    -- }
    
    -- æ¨èäº§å“
    recommended_products JSONB DEFAULT '[]',
    
    -- å¤„ç†ä¿¡æ¯
    processing_time DECIMAL(5,3),
    ai_model_version VARCHAR(50),
    
    -- é¡¹ç›®çŠ¶æ€
    project_status project_status_enum DEFAULT 'planned',
    progress_notes TEXT,
    completion_date TIMESTAMP,
    
    -- ç”¨æˆ·è¯„ä»·
    user_rating INTEGER CHECK (user_rating >= 1 AND user_rating <= 5),
    user_feedback TEXT,
    
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- é¢„ç®—èŒƒå›´æšä¸¾
CREATE TYPE budget_range_enum AS ENUM (
    'under_50', '50_to_150', '150_to_300', '300_to_500', 
    '500_to_1000', 'over_1000', 'no_limit'
);

-- æŠ€èƒ½æ°´å¹³æšä¸¾
CREATE TYPE skill_level_enum AS ENUM ('beginner', 'intermediate', 'advanced', 'expert');

-- é¡¹ç›®çŠ¶æ€æšä¸¾
CREATE TYPE project_status_enum AS ENUM (
    'planned', 'in_progress', 'completed', 'abandoned', 'on_hold'
);
```

#### **ç³»ç»Ÿç®¡ç†**
```sql
-- ç”¨æˆ·ä½¿ç”¨é…é¢è®°å½•
CREATE TABLE user_quotas (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    service_type service_type_enum NOT NULL,
    usage_date DATE NOT NULL,
    usage_count INTEGER DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    UNIQUE(user_id, service_type, usage_date)
);

CREATE TYPE service_type_enum AS ENUM (
    'tool_identification', 'project_analysis', 'api_call'
);

-- ç³»ç»Ÿé…ç½®è¡¨
CREATE TABLE system_configs (
    id SERIAL PRIMARY KEY,
    config_key VARCHAR(100) UNIQUE NOT NULL,
    config_value JSONB NOT NULL,
    description TEXT,
    is_public BOOLEAN DEFAULT FALSE,  -- æ˜¯å¦å¯¹å‰ç«¯å…¬å¼€
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- å®¡è®¡æ—¥å¿—
CREATE TABLE audit_logs (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE SET NULL,
    action VARCHAR(100) NOT NULL,  -- "login", "create_product", "delete_user"
    resource_type VARCHAR(50),  -- "user", "product", "project"
    resource_id INTEGER,
    changes JSONB,  -- å˜æ›´å‰åçš„æ•°æ®å¯¹æ¯”
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## ğŸ” è®¤è¯ç³»ç»Ÿè¯¦ç»†è®¾è®¡

### **ä¸ºä»€ä¹ˆé€‰æ‹©æ··åˆæœ¬åœ°è®¤è¯ï¼ˆJWTï¼‰**

ç»è¿‡æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº†**æ··åˆæœ¬åœ°è®¤è¯ç³»ç»Ÿ**è€ŒéAWS Cognitoï¼Œä¸»è¦åŸå› ï¼š

#### **æŠ€æœ¯å†³ç­–ç†ç”±**
1. **ç®€åŒ–å¤æ‚åº¦**: é¿å…Cognitoé…ç½®çš„å¤æ‚æ€§å’Œæ½œåœ¨é—®é¢˜
2. **æˆæœ¬æ•ˆç›Š**: æ—©æœŸç”¨æˆ·é‡ä¸‹æˆæœ¬æä½ï¼ŒåæœŸå¯æ‰©å±•
3. **å®Œå…¨æ§åˆ¶**: å¯ä»¥å®Œå…¨å®šåˆ¶ç”¨æˆ·æµç¨‹å’Œä½“éªŒ
4. **è°ƒè¯•å‹å¥½**: é—®é¢˜å®šä½å’Œè§£å†³æ›´åŠ ç›´è§‚
5. **å¿«é€Ÿè¿­ä»£**: éœ€æ±‚å˜æ›´æ—¶å¯ä»¥å¿«é€Ÿå®ç°

#### **æ¶æ„ä¼˜åŠ¿**
- âœ… **ç°ä»£åŒ–**: ä½¿ç”¨ä¸šç•Œæ ‡å‡†JWTæŠ€æœ¯
- âœ… **å®‰å…¨æ€§**: bcryptå¯†ç å“ˆå¸Œ + tokenæ’¤é”€æœºåˆ¶
- âœ… **å¯æ‰©å±•**: æŠ½è±¡æ¥å£è®¾è®¡ï¼Œä¾¿äºåæœŸå‡çº§
- âœ… **æ€§èƒ½**: æ— çŠ¶æ€tokenï¼Œæ”¯æŒé«˜å¹¶å‘
- âœ… **çµæ´»æ€§**: å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚çµæ´»è°ƒæ•´

### **JWTè®¤è¯ç³»ç»Ÿæ¶æ„**

#### **æ ¸å¿ƒç»„ä»¶è®¾è®¡**
```python
# core/auth.py - è®¤è¯æ ¸å¿ƒ
class AuthService:
    def __init__(self):
        self.secret_key = settings.SECRET_KEY
        self.algorithm = "HS256"
        self.access_token_expire = timedelta(minutes=30)  # çŸ­æœŸtoken
        self.refresh_token_expire = timedelta(days=7)     # é•¿æœŸtoken
        
    async def authenticate_user(self, email: str, password: str) -> Optional[User]:
        """éªŒè¯ç”¨æˆ·å‡­æ®"""
        user = await get_user_by_email(email)
        if not user or not verify_password(password, user.password_hash):
            return None
        return user
    
    async def create_tokens(self, user: User) -> TokenPair:
        """åˆ›å»ºè®¿é—®tokenå’Œåˆ·æ–°token"""
        # JWT payload
        access_payload = {
            "sub": str(user.id),
            "email": user.email,
            "user_type": user.user_type,
            "exp": datetime.utcnow() + self.access_token_expire,
            "iat": datetime.utcnow(),
            "type": "access"
        }
        
        refresh_payload = {
            "sub": str(user.id),
            "exp": datetime.utcnow() + self.refresh_token_expire,
            "iat": datetime.utcnow(),
            "type": "refresh",
            "jti": str(uuid.uuid4())  # ç”¨äºtokenæ’¤é”€
        }
        
        access_token = jwt.encode(access_payload, self.secret_key, self.algorithm)
        refresh_token = jwt.encode(refresh_payload, self.secret_key, self.algorithm)
        
        # å­˜å‚¨refresh tokenä»¥ä¾¿æ’¤é”€
        await self._store_refresh_token(refresh_payload["jti"], user.id)
        
        return TokenPair(
            access_token=access_token,
            refresh_token=refresh_token,
            token_type="bearer",
            expires_in=int(self.access_token_expire.total_seconds())
        )
    
    async def verify_token(self, token: str, token_type: str = "access") -> Optional[dict]:
        """éªŒè¯tokenå¹¶è¿”å›payload"""
        try:
            payload = jwt.decode(token, self.secret_key, algorithms=[self.algorithm])
            
            # æ£€æŸ¥tokenç±»å‹
            if payload.get("type") != token_type:
                return None
                
            # å¦‚æœæ˜¯refresh tokenï¼Œæ£€æŸ¥æ˜¯å¦è¢«æ’¤é”€
            if token_type == "refresh":
                jti = payload.get("jti")
                if not jti or await self._is_token_revoked(jti):
                    return None
                    
            return payload
            
        except jwt.ExpiredSignatureError:
            raise HTTPException(status_code=401, detail="Token expired")
        except jwt.JWTError:
            raise HTTPException(status_code=401, detail="Invalid token")
    
    async def refresh_access_token(self, refresh_token: str) -> TokenPair:
        """ä½¿ç”¨refresh tokenè·å–æ–°çš„access token"""
        payload = await self.verify_token(refresh_token, "refresh")
        if not payload:
            raise HTTPException(status_code=401, detail="Invalid refresh token")
            
        user = await get_user_by_id(int(payload["sub"]))
        if not user or not user.is_active:
            raise HTTPException(status_code=401, detail="User inactive")
            
        return await self.create_tokens(user)
    
    async def revoke_token(self, refresh_token: str) -> bool:
        """æ’¤é”€refresh token"""
        try:
            payload = jwt.decode(refresh_token, self.secret_key, algorithms=[self.algorithm])
            jti = payload.get("jti")
            if jti:
                await self._revoke_refresh_token(jti)
                return True
        except jwt.JWTError:
            pass
        return False

# å¯†ç å¤„ç†
class PasswordService:
    @staticmethod
    def hash_password(password: str) -> str:
        """å“ˆå¸Œå¯†ç """
        return bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt()).decode('utf-8')
    
    @staticmethod
    def verify_password(password: str, hashed: str) -> bool:
        """éªŒè¯å¯†ç """
        return bcrypt.checkpw(password.encode('utf-8'), hashed.encode('utf-8'))
    
    @staticmethod
    def generate_reset_token() -> str:
        """ç”Ÿæˆå¯†ç é‡ç½®token"""
        return secrets.token_urlsafe(32)
```

#### **æ•°æ®åº“æ‰©å±•**
```sql
-- ç”¨æˆ·è®¤è¯ç›¸å…³è¡¨
-- æ·»åŠ åˆ°ç”¨æˆ·è¡¨çš„å­—æ®µ
ALTER TABLE users ADD COLUMN email_verified BOOLEAN DEFAULT FALSE;
ALTER TABLE users ADD COLUMN email_verify_token VARCHAR(64);
ALTER TABLE users ADD COLUMN password_reset_token VARCHAR(64);
ALTER TABLE users ADD COLUMN password_reset_expires TIMESTAMP;
ALTER TABLE users ADD COLUMN failed_login_attempts INTEGER DEFAULT 0;
ALTER TABLE users ADD COLUMN locked_until TIMESTAMP;

-- refresh tokenç®¡ç†è¡¨
CREATE TABLE refresh_tokens (
    id SERIAL PRIMARY KEY,
    jti VARCHAR(36) UNIQUE NOT NULL,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    expires_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    revoked_at TIMESTAMP,
    is_revoked BOOLEAN DEFAULT FALSE
);

-- é‚®ç®±éªŒè¯ç è¡¨
CREATE TABLE email_verification_codes (
    id SERIAL PRIMARY KEY,
    email VARCHAR(100) NOT NULL,
    code VARCHAR(6) NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    used_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ç™»å½•å†å²è¡¨
CREATE TABLE login_history (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    ip_address INET NOT NULL,
    user_agent TEXT,
    login_successful BOOLEAN NOT NULL,
    failure_reason VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### **APIç«¯ç‚¹è®¾è®¡**
```python
# APIç«¯ç‚¹å®ç°
@router.post("/register", response_model=UserResponse)
async def register(
    user_data: UserCreate,
    db: AsyncSession = Depends(get_db)
):
    """ç”¨æˆ·æ³¨å†Œ"""
    # æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨
    existing_user = await get_user_by_email(user_data.email, db)
    if existing_user:
        raise HTTPException(status_code=400, detail="Email already registered")
    
    # åˆ›å»ºæ–°ç”¨æˆ·
    hashed_password = PasswordService.hash_password(user_data.password)
    user = User(
        username=user_data.username,
        email=user_data.email,
        password_hash=hashed_password,
        full_name=user_data.full_name
    )
    
    db.add(user)
    await db.commit()
    await db.refresh(user)
    
    # å‘é€éªŒè¯é‚®ä»¶
    await send_verification_email(user.email, user.email_verify_token)
    
    return UserResponse.from_orm(user)

@router.post("/login", response_model=TokenResponse)
async def login(
    credentials: LoginCredentials,
    request: Request,
    db: AsyncSession = Depends(get_db)
):
    """ç”¨æˆ·ç™»å½•"""
    # è®°å½•ç™»å½•å°è¯•
    ip_address = request.client.host
    user_agent = request.headers.get("user-agent")
    
    try:
        # éªŒè¯ç”¨æˆ·
        user = await auth_service.authenticate_user(credentials.email, credentials.password)
        if not user:
            await record_login_attempt(credentials.email, ip_address, False, "Invalid credentials")
            raise HTTPException(status_code=401, detail="Invalid credentials")
        
        # æ£€æŸ¥è´¦æˆ·çŠ¶æ€
        if not user.is_active:
            raise HTTPException(status_code=401, detail="Account disabled")
        
        if not user.email_verified:
            raise HTTPException(status_code=401, detail="Please verify your email first")
        
        # ç”Ÿæˆtokens
        tokens = await auth_service.create_tokens(user)
        
        # è®°å½•æˆåŠŸç™»å½•
        await record_login_attempt(user.email, ip_address, True)
        
        # æ›´æ–°æœ€åç™»å½•æ—¶é—´
        user.last_login = datetime.utcnow()
        user.failed_login_attempts = 0
        await db.commit()
        
        return TokenResponse(
            access_token=tokens.access_token,
            refresh_token=tokens.refresh_token,
            token_type=tokens.token_type,
            expires_in=tokens.expires_in,
            user=UserResponse.from_orm(user)
        )
        
    except HTTPException as e:
        await record_login_attempt(credentials.email, ip_address, False, str(e.detail))
        raise

@router.post("/refresh", response_model=TokenResponse)
async def refresh_token(
    refresh_data: RefreshTokenRequest
):
    """åˆ·æ–°è®¿é—®token"""
    tokens = await auth_service.refresh_access_token(refresh_data.refresh_token)
    return TokenResponse(
        access_token=tokens.access_token,
        refresh_token=tokens.refresh_token,
        token_type=tokens.token_type,
        expires_in=tokens.expires_in
    )

@router.post("/logout")
async def logout(
    logout_data: LogoutRequest,
    current_user: User = Depends(get_current_user)
):
    """ç”¨æˆ·ç™»å‡º"""
    success = await auth_service.revoke_token(logout_data.refresh_token)
    return {"message": "Logged out successfully", "success": success}
```

### **å®‰å…¨ç‰¹æ€§**

#### **å¯†ç å®‰å…¨**
- âœ… **bcryptå“ˆå¸Œ**: ä½¿ç”¨bcryptè¿›è¡Œå¯†ç å“ˆå¸Œï¼Œé˜²å½©è™¹è¡¨æ”»å‡»
- âœ… **ç›å€¼éšæœº**: æ¯ä¸ªå¯†ç ä½¿ç”¨ä¸åŒçš„éšæœºç›å€¼
- âœ… **å¼ºåº¦è¦æ±‚**: å¯†ç é•¿åº¦å’Œå¤æ‚åº¦è¦æ±‚
- âœ… **é˜²æš´åŠ›ç ´è§£**: å¤±è´¥æ¬¡æ•°é™åˆ¶å’Œè´¦æˆ·é”å®š

#### **Tokenå®‰å…¨**
- âœ… **åŒtokenæœºåˆ¶**: çŸ­æœŸaccess token + é•¿æœŸrefresh token
- âœ… **tokenæ’¤é”€**: refresh tokenå¯ä»¥è¢«ä¸»åŠ¨æ’¤é”€
- âœ… **ç­¾åéªŒè¯**: JWTç­¾åé˜²ç¯¡æ”¹
- âœ… **è¿‡æœŸæ§åˆ¶**: åˆç†çš„tokenè¿‡æœŸæ—¶é—´

#### **ä¼šè¯å®‰å…¨**
- âœ… **IPè¿½è¸ª**: è®°å½•ç™»å½•IPåœ°å€
- âœ… **è®¾å¤‡è¯†åˆ«**: åŸºäºUser-Agentçš„è®¾å¤‡è¯†åˆ«
- âœ… **å¼‚å¸¸æ£€æµ‹**: å¼‚å¸¸ç™»å½•è¡Œä¸ºæ£€æµ‹
- âœ… **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„è®¤è¯æ“ä½œæ—¥å¿—

### **æ¸è¿›å¼å¢å¼ºè®¡åˆ’**

#### **Phase 1: åŸºç¡€è®¤è¯** (ç«‹å³å®ç°)
```python
âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•/ç™»å‡º
âœ… JWT tokenç”Ÿæˆå’ŒéªŒè¯
âœ… å¯†ç å®‰å…¨å“ˆå¸Œå­˜å‚¨
âœ… åŸºç¡€çš„ç”¨æˆ·æƒé™æ£€æŸ¥
```

#### **Phase 2: å®‰å…¨å¢å¼º** (åç»­è¿­ä»£)
```python
ğŸ”„ é‚®ç®±éªŒè¯æœºåˆ¶
ğŸ”„ å¯†ç é‡ç½®åŠŸèƒ½
ğŸ”„ ç™»å½•å¤±è´¥é”å®š
ğŸ”„ åŒå› ç´ è®¤è¯(TOTP)
```

#### **Phase 3: é«˜çº§åŠŸèƒ½** (å¯é€‰å®ç°)
```python
ğŸ”® ç¤¾äº¤ç™»å½•é›†æˆ
ğŸ”® å•ç‚¹ç™»å½•(SSO)
ğŸ”® è®¾å¤‡ç®¡ç†
ğŸ”® ä¼šè¯ç®¡ç†
```

### **æœªæ¥å‡çº§è·¯å¾„**

è®¾è®¡æŠ½è±¡æ¥å£ï¼Œä¿ç•™å‘Cognitoæˆ–å…¶ä»–è®¤è¯æœåŠ¡è¿ç§»çš„å¯èƒ½ï¼š

```python
# æŠ½è±¡è®¤è¯æ¥å£
class AbstractAuthProvider:
    async def register(self, user_data: UserCreate) -> User: ...
    async def login(self, credentials: LoginCredentials) -> TokenPair: ...
    async def refresh_token(self, refresh_token: str) -> TokenPair: ...
    async def revoke_token(self, token: str) -> bool: ...
    async def verify_email(self, token: str) -> bool: ...
    async def reset_password(self, email: str) -> bool: ...

# å½“å‰å®ç°
class JWTAuthProvider(AbstractAuthProvider):
    # JWT + æœ¬åœ°æ•°æ®åº“å®ç°

# æœªæ¥å¯é€‰å®ç°
class CognitoAuthProvider(AbstractAuthProvider):
    # AWS Cognitoå®ç° (å¦‚æœéœ€è¦)
    
class Auth0Provider(AbstractAuthProvider):
    # Auth0å®ç° (å¦‚æœéœ€è¦)
```

è¿™æ ·çš„è®¾è®¡ç¡®ä¿äº†å½“å‰å®ç°çš„ç®€å•æ€§ï¼ŒåŒæ—¶ä¸ºæœªæ¥çš„æ‰©å±•ä¿ç•™äº†çµæ´»æ€§ã€‚

---

### APIè®¾è®¡

#### **è®¤è¯æˆæƒ API**
```typescript
// ç”¨æˆ·è®¤è¯
POST   /api/v1/auth/register
POST   /api/v1/auth/login
POST   /api/v1/auth/logout
POST   /api/v1/auth/refresh
GET    /api/v1/auth/me
POST   /api/v1/auth/verify-email
POST   /api/v1/auth/forgot-password
POST   /api/v1/auth/reset-password
PUT    /api/v1/auth/change-password
```

#### **ç”¨æˆ·ç®¡ç† API**
```typescript
// ç”¨æˆ·èµ„æ–™
GET    /api/v1/users/profile
PUT    /api/v1/users/profile
POST   /api/v1/users/avatar
GET    /api/v1/users/preferences
PUT    /api/v1/users/preferences
GET    /api/v1/users/usage-stats
GET    /api/v1/users/history
DELETE /api/v1/users/history/{id}
```

#### **AIæœåŠ¡ API**
```typescript
// å·¥å…·è¯†åˆ«
POST   /api/v1/ai/tools/identify        // ä¸Šä¼ å›¾ç‰‡è¯†åˆ«å·¥å…·
GET    /api/v1/ai/tools/history         // è·å–è¯†åˆ«å†å²
GET    /api/v1/ai/tools/{id}           // è·å–å•ä¸ªè¯†åˆ«ç»“æœ
DELETE /api/v1/ai/tools/{id}           // åˆ é™¤è¯†åˆ«è®°å½•
POST   /api/v1/ai/tools/{id}/feedback  // æä¾›ç”¨æˆ·åé¦ˆ

// é¡¹ç›®åˆ†æ
POST   /api/v1/ai/projects/analyze     // åˆ†æDIYé¡¹ç›®
GET    /api/v1/ai/projects/history     // è·å–åˆ†æå†å²
GET    /api/v1/ai/projects/{id}        // è·å–å•ä¸ªåˆ†æç»“æœ
PUT    /api/v1/ai/projects/{id}        // æ›´æ–°é¡¹ç›®çŠ¶æ€
DELETE /api/v1/ai/projects/{id}        // åˆ é™¤åˆ†æè®°å½•
POST   /api/v1/ai/projects/{id}/rate   // é¡¹ç›®è¯„ä»·
```

#### **äº§å“æœåŠ¡ API**
```typescript
// äº§å“æµè§ˆ
GET    /api/v1/products                // äº§å“åˆ—è¡¨(æ”¯æŒæœç´¢ã€è¿‡æ»¤ã€æ’åº)
GET    /api/v1/products/{id}           // äº§å“è¯¦æƒ…
GET    /api/v1/products/categories     // äº§å“åˆ†ç±»
GET    /api/v1/products/brands         // å“ç‰Œåˆ—è¡¨
GET    /api/v1/products/merchants      // å•†å®¶åˆ—è¡¨
POST   /api/v1/products/{id}/view      // è®°å½•æµè§ˆ
POST   /api/v1/products/{id}/click     // è®°å½•ç‚¹å‡»
GET    /api/v1/products/recommendations // ä¸ªæ€§åŒ–æ¨è
```

#### **ç®¡ç†å‘˜ API**
```typescript
// äº§å“ç®¡ç†
GET    /api/v1/admin/products          // ç®¡ç†äº§å“åˆ—è¡¨
POST   /api/v1/admin/products          // åˆ›å»ºäº§å“
PUT    /api/v1/admin/products/{id}     // æ›´æ–°äº§å“
DELETE /api/v1/admin/products/{id}     // åˆ é™¤äº§å“
POST   /api/v1/admin/products/import   // æ‰¹é‡å¯¼å…¥
POST   /api/v1/admin/products/sync     // åŒæ­¥ä»·æ ¼ä¿¡æ¯

// ç”¨æˆ·ç®¡ç†
GET    /api/v1/admin/users             // ç”¨æˆ·åˆ—è¡¨
GET    /api/v1/admin/users/{id}        // ç”¨æˆ·è¯¦æƒ…
PUT    /api/v1/admin/users/{id}        // æ›´æ–°ç”¨æˆ·
PUT    /api/v1/admin/users/{id}/type   // å˜æ›´ç”¨æˆ·ç±»å‹
POST   /api/v1/admin/users/{id}/disable // ç¦ç”¨ç”¨æˆ·

// ç³»ç»Ÿç®¡ç†
GET    /api/v1/admin/analytics         // ç³»ç»Ÿç»Ÿè®¡
GET    /api/v1/admin/configs           // ç³»ç»Ÿé…ç½®
PUT    /api/v1/admin/configs/{key}     // æ›´æ–°é…ç½®
GET    /api/v1/admin/logs              // å®¡è®¡æ—¥å¿—
```

---

## ğŸ¨ å‰ç«¯æ¶æ„è®¾è®¡

### é¡¹ç›®ç»“æ„
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                    # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ App.vue                    # æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ components/                # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ layout/               # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ AppHeader.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ AppSidebar.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ AppFooter.vue
â”‚   â”‚   â”‚   â””â”€â”€ AppBreadcrumb.vue
â”‚   â”‚   â”œâ”€â”€ forms/                # è¡¨å•ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageUploader.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ FormField.vue
â”‚   â”‚   â”‚   â””â”€â”€ SearchBox.vue
â”‚   â”‚   â”œâ”€â”€ ui/                   # UIç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ LoadingSpinner.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ EmptyState.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ ConfirmDialog.vue
â”‚   â”‚   â”‚   â””â”€â”€ ToastNotification.vue
â”‚   â”‚   â””â”€â”€ business/             # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ ProductCard.vue
â”‚   â”‚       â”œâ”€â”€ ToolResult.vue
â”‚   â”‚       â”œâ”€â”€ ProjectAnalysis.vue
â”‚   â”‚       â””â”€â”€ UserAvatar.vue
â”‚   â”œâ”€â”€ views/                    # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ auth/                 # è®¤è¯é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ LoginView.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ RegisterView.vue
â”‚   â”‚   â”‚   â””â”€â”€ ForgotPasswordView.vue
â”‚   â”‚   â”œâ”€â”€ dashboard/            # ä»ªè¡¨æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ DashboardView.vue
â”‚   â”‚   â”‚   â””â”€â”€ ProfileView.vue
â”‚   â”‚   â”œâ”€â”€ tools/                # å·¥å…·è¯†åˆ«
â”‚   â”‚   â”‚   â”œâ”€â”€ ToolIdentificationView.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ ToolHistoryView.vue
â”‚   â”‚   â”‚   â””â”€â”€ ToolResultView.vue
â”‚   â”‚   â”œâ”€â”€ projects/             # é¡¹ç›®åˆ†æ
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectAnalysisView.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectHistoryView.vue
â”‚   â”‚   â”‚   â””â”€â”€ ProjectDetailView.vue
â”‚   â”‚   â”œâ”€â”€ products/             # äº§å“æµè§ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductListView.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductDetailView.vue
â”‚   â”‚   â”‚   â””â”€â”€ ProductCategoryView.vue
â”‚   â”‚   â””â”€â”€ admin/                # ç®¡ç†å‘˜é¡µé¢
â”‚   â”‚       â”œâ”€â”€ AdminDashboardView.vue
â”‚   â”‚       â”œâ”€â”€ ProductManagementView.vue
â”‚   â”‚       â”œâ”€â”€ UserManagementView.vue
â”‚   â”‚       â””â”€â”€ SystemConfigView.vue
â”‚   â”œâ”€â”€ stores/                   # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ auth.ts              # è®¤è¯çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ user.ts              # ç”¨æˆ·ä¿¡æ¯
â”‚   â”‚   â”œâ”€â”€ products.ts          # äº§å“æ•°æ®
â”‚   â”‚   â”œâ”€â”€ tools.ts             # å·¥å…·è¯†åˆ«
â”‚   â”‚   â”œâ”€â”€ projects.ts          # é¡¹ç›®åˆ†æ
â”‚   â”‚   â””â”€â”€ app.ts               # åº”ç”¨å…¨å±€çŠ¶æ€
â”‚   â”œâ”€â”€ composables/             # ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ useAuth.ts           # è®¤è¯é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ useApi.ts            # APIè°ƒç”¨
â”‚   â”‚   â”œâ”€â”€ useFileUpload.ts     # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚   â”œâ”€â”€ usePermission.ts     # æƒé™æ£€æŸ¥
â”‚   â”‚   â””â”€â”€ useLocalStorage.ts   # æœ¬åœ°å­˜å‚¨
â”‚   â”œâ”€â”€ api/                     # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ client.ts            # HTTPå®¢æˆ·ç«¯é…ç½®
â”‚   â”‚   â”œâ”€â”€ auth.ts              # è®¤è¯API
â”‚   â”‚   â”œâ”€â”€ products.ts          # äº§å“API
â”‚   â”‚   â”œâ”€â”€ tools.ts             # å·¥å…·è¯†åˆ«API
â”‚   â”‚   â”œâ”€â”€ projects.ts          # é¡¹ç›®åˆ†æAPI
â”‚   â”‚   â””â”€â”€ admin.ts             # ç®¡ç†å‘˜API
â”‚   â”œâ”€â”€ router/                  # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ index.ts             # ä¸»è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ guards.ts            # è·¯ç”±å®ˆå«
â”‚   â”‚   â””â”€â”€ routes/              # è·¯ç”±æ¨¡å—
â”‚   â”‚       â”œâ”€â”€ auth.ts
â”‚   â”‚       â”œâ”€â”€ dashboard.ts
â”‚   â”‚       â”œâ”€â”€ tools.ts
â”‚   â”‚       â”œâ”€â”€ projects.ts
â”‚   â”‚       â”œâ”€â”€ products.ts
â”‚   â”‚       â””â”€â”€ admin.ts
â”‚   â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ request.ts           # è¯·æ±‚å°è£…
â”‚   â”‚   â”œâ”€â”€ storage.ts           # å­˜å‚¨å·¥å…·
â”‚   â”‚   â”œâ”€â”€ validation.ts        # è¡¨å•éªŒè¯
â”‚   â”‚   â”œâ”€â”€ format.ts            # æ ¼å¼åŒ–å·¥å…·
â”‚   â”‚   â””â”€â”€ constants.ts         # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ types/                   # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ api.ts               # APIç±»å‹
â”‚   â”‚   â”œâ”€â”€ user.ts              # ç”¨æˆ·ç±»å‹
â”‚   â”‚   â”œâ”€â”€ product.ts           # äº§å“ç±»å‹
â”‚   â”‚   â””â”€â”€ common.ts            # é€šç”¨ç±»å‹
â”‚   â”œâ”€â”€ locales/                 # å›½é™…åŒ–
â”‚   â”‚   â”œâ”€â”€ index.ts             # i18né…ç½®
â”‚   â”‚   â”œâ”€â”€ en.ts                # è‹±æ–‡
â”‚   â”‚   â””â”€â”€ zh.ts                # ä¸­æ–‡
â”‚   â”œâ”€â”€ styles/                  # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ main.scss            # ä¸»æ ·å¼
â”‚   â”‚   â”œâ”€â”€ variables.scss       # å˜é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ mixins.scss          # æ··åˆå™¨
â”‚   â”‚   â””â”€â”€ components.scss      # ç»„ä»¶æ ·å¼
â”‚   â””â”€â”€ assets/                  # é™æ€èµ„æº
â”‚       â”œâ”€â”€ images/
â”‚       â”œâ”€â”€ icons/
â”‚       â””â”€â”€ fonts/
â”œâ”€â”€ public/                      # å…¬å…±æ–‡ä»¶
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ tailwind.config.js          # Tailwind CSSé…ç½®
```

### çŠ¶æ€ç®¡ç†è®¾è®¡
```typescript
// stores/auth.ts - è®¤è¯çŠ¶æ€
export const useAuthStore = defineStore('auth', {
  state: (): AuthState => ({
    user: null,
    token: null,
    refreshToken: null,
    isAuthenticated: false,
    permissions: [],
    loginTime: null
  }),
  
  getters: {
    isAdmin: (state) => state.user?.userType === 'admin',
    isPremium: (state) => ['premium', 'admin'].includes(state.user?.userType || ''),
    hasPermission: (state) => (permission: string) => 
      state.permissions.includes(permission),
    userQuota: (state) => getUserQuota(state.user?.userType)
  },
  
  actions: {
    async login(credentials: LoginCredentials),
    async register(userData: RegisterData),
    async logout(),
    async refreshAuth(),
    async updateProfile(data: ProfileData),
    clearAuth()
  }
})

// stores/products.ts - äº§å“çŠ¶æ€
export const useProductsStore = defineStore('products', {
  state: (): ProductsState => ({
    products: [],
    categories: [],
    brands: [],
    merchants: [],
    filters: defaultFilters,
    pagination: defaultPagination,
    loading: false,
    selectedProduct: null
  }),
  
  getters: {
    filteredProducts: (state) => applyFilters(state.products, state.filters),
    categoryTree: (state) => buildCategoryTree(state.categories),
    featuredProducts: (state) => state.products.filter(p => p.isFeatured)
  },
  
  actions: {
    async fetchProducts(params?: ProductParams),
    async fetchProductById(id: number),
    async fetchCategories(),
    async searchProducts(query: string),
    setFilters(filters: ProductFilters),
    trackProductView(productId: number),
    trackProductClick(productId: number)
  }
})
```

---

## ğŸ”§ åç«¯æ¶æ„è®¾è®¡

### é¡¹ç›®ç»“æ„
```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                  # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database.py              # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ dependencies.py          # ä¾èµ–æ³¨å…¥
â”‚   â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py             # åŸºç¡€æ¨¡å‹ç±»
â”‚   â”‚   â”œâ”€â”€ user.py             # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ product.py          # äº§å“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tool_identification.py
â”‚   â”‚   â”œâ”€â”€ project_analysis.py
â”‚   â”‚   â””â”€â”€ audit_log.py
â”‚   â”œâ”€â”€ schemas/                 # Pydanticæ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py             # åŸºç¡€æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ product.py
â”‚   â”‚   â”œâ”€â”€ tool.py
â”‚   â”‚   â”œâ”€â”€ project.py
â”‚   â”‚   â””â”€â”€ response.py         # å“åº”æ¨¡å¼
â”‚   â”œâ”€â”€ api/                     # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ deps.py             # APIä¾èµ–
â”‚   â”‚   â””â”€â”€ v1/                 # v1ç‰ˆæœ¬API
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ auth.py
â”‚   â”‚       â”œâ”€â”€ users.py
â”‚   â”‚       â”œâ”€â”€ products.py
â”‚   â”‚       â”œâ”€â”€ tools.py
â”‚   â”‚       â”œâ”€â”€ projects.py
â”‚   â”‚       â””â”€â”€ admin.py
â”‚   â”œâ”€â”€ services/                # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth_service.py     # è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ user_service.py     # ç”¨æˆ·æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ product_service.py  # äº§å“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ai_service.py       # AIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ file_service.py     # æ–‡ä»¶æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ notification_service.py
â”‚   â”‚   â””â”€â”€ analytics_service.py
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ security.py         # å®‰å…¨å·¥å…·
â”‚   â”‚   â”œâ”€â”€ permissions.py      # æƒé™ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ exceptions.py       # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”œâ”€â”€ middleware.py       # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ logging.py          # æ—¥å¿—é…ç½®
â”‚   â”œâ”€â”€ utils/                   # å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ image_processor.py  # å›¾åƒå¤„ç†
â”‚   â”‚   â”œâ”€â”€ validators.py       # éªŒè¯å™¨
â”‚   â”‚   â”œâ”€â”€ helpers.py          # è¾…åŠ©å‡½æ•°
â”‚   â”‚   â””â”€â”€ cache.py            # ç¼“å­˜å·¥å…·
â”‚   â””â”€â”€ workers/                 # åå°ä»»åŠ¡
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ celery_app.py       # Celeryé…ç½®
â”‚       â”œâ”€â”€ ai_tasks.py         # AIå¤„ç†ä»»åŠ¡
â”‚       â””â”€â”€ maintenance_tasks.py # ç»´æŠ¤ä»»åŠ¡
â”œâ”€â”€ migrations/                  # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ tests/                       # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py             # æµ‹è¯•é…ç½®
â”‚   â”œâ”€â”€ test_auth.py
â”‚   â”œâ”€â”€ test_products.py
â”‚   â””â”€â”€ test_ai_services.py
â”œâ”€â”€ scripts/                     # è„šæœ¬æ–‡ä»¶
â”‚   â”œâ”€â”€ init_db.py              # åˆå§‹åŒ–æ•°æ®åº“
â”‚   â”œâ”€â”€ create_admin.py         # åˆ›å»ºç®¡ç†å‘˜
â”‚   â””â”€â”€ migrate_data.py         # æ•°æ®è¿ç§»
â”œâ”€â”€ requirements/                # ä¾èµ–æ–‡ä»¶
â”‚   â”œâ”€â”€ base.txt                # åŸºç¡€ä¾èµ–
â”‚   â”œâ”€â”€ dev.txt                 # å¼€å‘ä¾èµ–
â”‚   â””â”€â”€ prod.txt                # ç”Ÿäº§ä¾èµ–
â”œâ”€â”€ .env.example                # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ pyproject.toml              # é¡¹ç›®é…ç½®
â””â”€â”€ README.md
```

### æœåŠ¡å±‚è®¾è®¡
```python
# services/ai_service.py - AIæœåŠ¡
class AIService:
    def __init__(self, openai_client: OpenAI):
        self.openai_client = openai_client
    
    async def identify_tool(
        self, 
        image_data: bytes, 
        user_id: int
    ) -> ToolIdentificationResult:
        """è¯†åˆ«å·¥å…·å›¾åƒ"""
        # å›¾åƒé¢„å¤„ç†
        processed_image = await self._preprocess_image(image_data)
        
        # è°ƒç”¨OpenAI Vision API
        result = await self._call_vision_api(processed_image)
        
        # ä¿å­˜è¯†åˆ«ç»“æœ
        identification = await self._save_identification(result, user_id)
        
        # ç”Ÿæˆäº§å“æ¨è
        recommendations = await self._generate_recommendations(result)
        
        return ToolIdentificationResult(
            identification=identification,
            recommendations=recommendations
        )
    
    async def analyze_project(
        self, 
        images: List[bytes], 
        description: str,
        user_preferences: dict,
        user_id: int
    ) -> ProjectAnalysisResult:
        """åˆ†æDIYé¡¹ç›®"""
        # å¤šå›¾åƒå¤„ç†
        processed_images = await self._preprocess_images(images)
        
        # æ„å»ºåˆ†æprompt
        prompt = self._build_analysis_prompt(description, user_preferences)
        
        # AIåˆ†æ
        analysis = await self._call_analysis_api(processed_images, prompt)
        
        # è§£æç»“æœå¹¶éªŒè¯
        parsed_result = await self._parse_analysis_result(analysis)
        
        # ä¿å­˜åˆ†æç»“æœ
        project_analysis = await self._save_analysis(parsed_result, user_id)
        
        return ProjectAnalysisResult(
            analysis=project_analysis,
            recommendations=parsed_result.recommendations
        )

# services/user_service.py - ç”¨æˆ·æœåŠ¡
class UserService:
    def __init__(self, db: AsyncSession):
        self.db = db
    
    async def check_quota(
        self, 
        user_id: int, 
        service_type: str
    ) -> QuotaCheckResult:
        """æ£€æŸ¥ç”¨æˆ·é…é¢"""
        user = await self._get_user(user_id)
        quota_config = get_quota_config(user.user_type)
        
        if quota_config[service_type]['daily_limit'] == -1:
            return QuotaCheckResult(allowed=True, remaining=-1)
        
        usage_today = await self._get_daily_usage(user_id, service_type)
        remaining = quota_config[service_type]['daily_limit'] - usage_today
        
        return QuotaCheckResult(
            allowed=remaining > 0,
            remaining=max(0, remaining)
        )
    
    async def record_usage(
        self, 
        user_id: int, 
        service_type: str
    ) -> None:
        """è®°å½•æœåŠ¡ä½¿ç”¨"""
        today = date.today()
        
        # åŸå­æ€§æ“ä½œï¼šå¢åŠ ä½¿ç”¨æ¬¡æ•°
        await self.db.execute(
            text("""
                INSERT INTO user_quotas (user_id, service_type, usage_date, usage_count)
                VALUES (:user_id, :service_type, :usage_date, 1)
                ON CONFLICT (user_id, service_type, usage_date)
                DO UPDATE SET usage_count = user_quotas.usage_count + 1
            """),
            {
                "user_id": user_id,
                "service_type": service_type,
                "usage_date": today
            }
        )
        await self.db.commit()
```

### ä¸­é—´ä»¶è®¾è®¡
```python
# core/middleware.py - è‡ªå®šä¹‰ä¸­é—´ä»¶
class AuthenticationMiddleware:
    """JWTè®¤è¯ä¸­é—´ä»¶"""
    
    async def __call__(self, request: Request, call_next):
        # è·å–token
        token = self._extract_token(request)
        
        if token:
            try:
                # éªŒè¯token
                payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
                user_id = payload.get("sub")
                
                # æ£€æŸ¥tokenæ˜¯å¦è¢«æ’¤é”€
                if not await self._is_token_revoked(payload.get("jti")):
                    request.state.user_id = user_id
                    request.state.user = await get_user_by_id(user_id)
            except JWTError:
                pass  # æ— æ•ˆtokenï¼Œç»§ç»­å¤„ç†ä½†ä¸è®¾ç½®ç”¨æˆ·ä¿¡æ¯
        
        response = await call_next(request)
        return response

class RateLimitMiddleware:
    """APIé™æµä¸­é—´ä»¶"""
    
    def __init__(self, calls: int = 100, period: int = 3600):
        self.calls = calls
        self.period = period
        self.cache = {}
    
    async def __call__(self, request: Request, call_next):
        client_ip = self._get_client_ip(request)
        
        # æ£€æŸ¥é™æµ
        if await self._is_rate_limited(client_ip):
            raise HTTPException(
                status_code=429,
                detail="Rate limit exceeded"
            )
        
        # è®°å½•è¯·æ±‚
        await self._record_request(client_ip)
        
        response = await call_next(request)
        return response

class LoggingMiddleware:
    """è¯·æ±‚æ—¥å¿—ä¸­é—´ä»¶"""
    
    async def __call__(self, request: Request, call_next):
        start_time = time.time()
        
        response = await call_next(request)
        
        process_time = time.time() - start_time
        
        # è®°å½•è®¿é—®æ—¥å¿—
        logger.info(
            f"{request.method} {request.url.path} - "
            f"{response.status_code} - {process_time:.3f}s"
        )
        
        return response
```

---

## ğŸš€ å®æ–½è®¡åˆ’

### Phase 1: é¡¹ç›®åˆå§‹åŒ– (1å¤©)
#### **ç¯å¢ƒæ­å»º**
- åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„
- è®¾ç½®Pythonè™šæ‹Ÿç¯å¢ƒå’ŒNode.jsç¯å¢ƒ
- é…ç½®å¼€å‘å·¥å…· (VSCode, Git, Docker)
- è®¾ç½®ä»£ç æ ¼å¼åŒ– (Prettier, Black, isort)

#### **åŸºç¡€é…ç½®**
- é…ç½®FastAPIé¡¹ç›®åŸºç¡€ç»“æ„
- è®¾ç½®Vue 3é¡¹ç›®è„šæ‰‹æ¶
- é…ç½®æ•°æ®åº“è¿æ¥ (PostgreSQL + SQLAlchemy)
- è®¾ç½®åŸºç¡€çš„Dockerå®¹å™¨

#### **å¼€å‘æµç¨‹**
- é…ç½®Gitå·¥ä½œæµ (main/developåˆ†æ”¯)
- è®¾ç½®CI/CDåŸºç¡€é…ç½® (GitHub Actions)
- åˆ›å»ºå¼€å‘æ–‡æ¡£æ¨¡æ¿

### Phase 2: æ ¸å¿ƒåç«¯å¼€å‘ (2-3å¤©)
#### **è®¤è¯ç³»ç»Ÿ** (0.5å¤©)
```python
# å®ç°JWTè®¤è¯
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•/ç™»å‡º
- Tokenåˆ·æ–°æœºåˆ¶
- å¯†ç é‡ç½®æµç¨‹
- é‚®ç®±éªŒè¯åŠŸèƒ½
```

#### **æ•°æ®æ¨¡å‹å’ŒAPI** (1å¤©)
```python
# åˆ›å»ºæ ¸å¿ƒæ•°æ®æ¨¡å‹
- User, Product, ToolIdentification, ProjectAnalysisæ¨¡å‹
- æ•°æ®åº“è¿ç§»æ–‡ä»¶
- åŸºç¡€CRUDæ“ä½œ
- æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
```

#### **AIæœåŠ¡é›†æˆ** (1å¤©)
```python
# OpenAI APIé›†æˆ
- å›¾åƒé¢„å¤„ç†æœåŠ¡
- å·¥å…·è¯†åˆ«API
- é¡¹ç›®åˆ†æAPI
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
```

#### **æƒé™å’Œé…é¢ç³»ç»Ÿ** (0.5å¤©)
```python
# å®ç°ç”¨æˆ·æƒé™æ§åˆ¶
- åŸºäºè§’è‰²çš„æƒé™ç³»ç»Ÿ
- ä½¿ç”¨é…é¢æ£€æŸ¥å’Œè®°å½•
- APIé™æµæœºåˆ¶
```

### Phase 3: å‰ç«¯å¼€å‘ (2å¤©)
#### **åŸºç¡€æ¶æ„** (0.5å¤©)
```typescript
// é¡¹ç›®æ¶æ„æ­å»º
- Vue 3 + TypeScript + Viteé…ç½®
- Element Plusé›†æˆ
- PiniaçŠ¶æ€ç®¡ç†è®¾ç½®
- è·¯ç”±é…ç½®å’Œå®ˆå«
```

#### **æ ¸å¿ƒé¡µé¢** (1å¤©)
```vue
<!-- ä¸»è¦é¡µé¢å®ç° -->
- ç”¨æˆ·è®¤è¯é¡µé¢ (ç™»å½•/æ³¨å†Œ)
- å·¥å…·è¯†åˆ«ç•Œé¢
- é¡¹ç›®åˆ†æç•Œé¢
- äº§å“æµè§ˆé¡µé¢
```

#### **ç®¡ç†ç•Œé¢** (0.5å¤©)
```vue
<!-- ç®¡ç†å‘˜åŠŸèƒ½ -->
- äº§å“ç®¡ç†ç•Œé¢
- ç”¨æˆ·ç®¡ç†ç•Œé¢
- ç³»ç»Ÿç»Ÿè®¡ä»ªè¡¨æ¿
```

### Phase 4: é›†æˆæµ‹è¯•å’Œä¼˜åŒ– (1å¤©)
#### **åŠŸèƒ½æµ‹è¯•**
- APIç«¯ç‚¹é›†æˆæµ‹è¯•
- å‰åç«¯æ•°æ®æµæµ‹è¯•
- ç”¨æˆ·æƒé™æµ‹è¯•
- æ–‡ä»¶ä¸Šä¼ æµ‹è¯•

#### **æ€§èƒ½ä¼˜åŒ–**
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- å›¾åƒå¤„ç†ä¼˜åŒ–
- å‰ç«¯ä»£ç åˆ†å‰²
- APIå“åº”ç¼“å­˜

#### **å®‰å…¨åŠ å›º**
- SQLæ³¨å…¥é˜²æŠ¤
- XSSæ”»å‡»é˜²æŠ¤
- CSRFä¿æŠ¤
- æ•æ„Ÿä¿¡æ¯åŠ å¯†

### Phase 5: éƒ¨ç½²å’Œç›‘æ§ (0.5å¤©)
#### **ç”Ÿäº§éƒ¨ç½²**
- Dockerå®¹å™¨åŒ–
- ç¯å¢ƒå˜é‡é…ç½®
- æ•°æ®åº“å¤‡ä»½ç­–ç•¥
- SSLè¯ä¹¦é…ç½®

#### **ç›‘æ§å’Œæ—¥å¿—**
- åº”ç”¨æ€§èƒ½ç›‘æ§
- é”™è¯¯è¿½è¸ªç³»ç»Ÿ
- æ—¥å¿—æ”¶é›†å’Œåˆ†æ
- å¥åº·æ£€æŸ¥ç«¯ç‚¹

---

## ğŸ”’ å®‰å…¨æ€§è€ƒè™‘

### **è®¤è¯å’Œæˆæƒ**
```python
# JWTå®‰å…¨å®è·µ
- çŸ­æœŸè®¿é—®token (15åˆ†é’Ÿ)
- é•¿æœŸåˆ·æ–°token (7å¤©)
- Tokenæ’¤é”€æœºåˆ¶
- å®‰å…¨çš„å¯†ç å­˜å‚¨ (bcrypt)

# æƒé™æ§åˆ¶
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)
- APIç«¯ç‚¹æƒé™éªŒè¯
- èµ„æºçº§åˆ«æƒé™æ£€æŸ¥
- ç®¡ç†å‘˜æ“ä½œå®¡è®¡
```

### **æ•°æ®ä¿æŠ¤**
```python
# æ•æ„Ÿæ•°æ®å¤„ç†
- ä¸ªäººä¿¡æ¯åŠ å¯†å­˜å‚¨
- å¯†ç ä¸å¯é€†å“ˆå¸Œ
- ä¼šè¯æ•°æ®ä¿æŠ¤
- æ•°æ®å¤‡ä»½åŠ å¯†

# APIå®‰å…¨
- è¯·æ±‚é¢‘ç‡é™åˆ¶
- å‚æ•°éªŒè¯å’Œæ¸…ç†
- SQLæ³¨å…¥é˜²æŠ¤
- XSSæ”»å‡»é˜²æŠ¤
```

### **æ–‡ä»¶å®‰å…¨**
```python
# æ–‡ä»¶ä¸Šä¼ å®‰å…¨
- æ–‡ä»¶ç±»å‹éªŒè¯
- æ–‡ä»¶å¤§å°é™åˆ¶
- ç—…æ¯’æ‰«æé›†æˆ
- å®‰å…¨çš„æ–‡ä»¶å­˜å‚¨è·¯å¾„
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### **æ•°æ®åº“ä¼˜åŒ–**
```sql
-- ç´¢å¼•ä¼˜åŒ–
CREATE INDEX idx_products_category ON products(category);
CREATE INDEX idx_products_active ON products(is_active) WHERE is_active = true;
CREATE INDEX idx_tool_identifications_user_created ON tool_identifications(user_id, created_at);

-- æŸ¥è¯¢ä¼˜åŒ–
- ä½¿ç”¨é€‚å½“çš„ç´¢å¼•
- é¿å…N+1æŸ¥è¯¢é—®é¢˜
- å®ç°æ•°æ®åº“è¿æ¥æ± 
- æŸ¥è¯¢ç»“æœç¼“å­˜
```

### **APIæ€§èƒ½**
```python
# ç¼“å­˜ç­–ç•¥
- Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- APIå“åº”ç¼“å­˜
- æ•°æ®åº“æŸ¥è¯¢ç»“æœç¼“å­˜
- é™æ€èµ„æºCDN

# å¼‚æ­¥å¤„ç†
- ä½¿ç”¨å¼‚æ­¥I/O (asyncio)
- åå°ä»»åŠ¡é˜Ÿåˆ— (Celery)
- å›¾åƒå¤„ç†å¼‚æ­¥åŒ–
- AI APIè°ƒç”¨ä¼˜åŒ–
```

### **å‰ç«¯æ€§èƒ½**
```typescript
// ä¼˜åŒ–ç­–ç•¥
- ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- ç»„ä»¶çº§åˆ«çš„ç¼“å­˜
- å›¾ç‰‡æ‡’åŠ è½½å’Œå‹ç¼©
- è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨
- PWAæ”¯æŒ
```

---

## ğŸ”® æœªæ¥æ‰©å±•æ–¹å‘

### **åŠŸèƒ½æ‰©å±•**
- **ç¤¾åŒºåŠŸèƒ½**: ç”¨æˆ·é¡¹ç›®åˆ†äº«ã€è¯„è®ºã€è¯„åˆ†ç³»ç»Ÿ
- **è§†é¢‘åˆ†æ**: æ”¯æŒè§†é¢‘æ ¼å¼çš„é¡¹ç›®åˆ†æ
- **AR/VRé›†æˆ**: è™šæ‹Ÿç°å®é¡¹ç›®é¢„è§ˆ
- **ç§»åŠ¨åº”ç”¨**: React Nativeæˆ–Flutterç§»åŠ¨ç«¯
- **è¯­éŸ³åŠ©æ‰‹**: è¯­éŸ³æŒ‡ä»¤å’Œå›ç­”

### **AIèƒ½åŠ›å¢å¼º**
- **è‡ªå®šä¹‰æ¨¡å‹**: è®­ç»ƒä¸“é—¨çš„å·¥å…·è¯†åˆ«æ¨¡å‹
- **å®æ—¶æ¨è**: åŸºäºç”¨æˆ·è¡Œä¸ºçš„æ™ºèƒ½æ¨è
- **ä»·æ ¼é¢„æµ‹**: å•†å“ä»·æ ¼è¶‹åŠ¿åˆ†æ
- **é¡¹ç›®éš¾åº¦è¯„ä¼°**: æ™ºèƒ½éš¾åº¦è¯„ä¼°ç³»ç»Ÿ

### **å•†ä¸šåŠŸèƒ½**
- **ç”µå•†é›†æˆ**: ç›´æ¥è´­ä¹°åŠŸèƒ½
- **è®¢é˜…æœåŠ¡**: ä¼šå‘˜è®¢é˜…ç³»ç»Ÿ
- **å¹¿å‘Šå¹³å°**: å•†å®¶å¹¿å‘ŠæŠ•æ”¾
- **æ•°æ®åˆ†æ**: ç”¨æˆ·è¡Œä¸ºåˆ†æä»ªè¡¨æ¿

### **æŠ€æœ¯å‡çº§**
- **å¾®æœåŠ¡æ¶æ„**: æœåŠ¡æ‹†åˆ†å’Œç‹¬ç«‹éƒ¨ç½²
- **GraphQL API**: æ›´çµæ´»çš„APIæŸ¥è¯¢
- **å®æ—¶é€šä¿¡**: WebSocketå®æ—¶åŠŸèƒ½
- **è¾¹ç¼˜è®¡ç®—**: CDNè¾¹ç¼˜å‡½æ•°éƒ¨ç½²

---

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### **å¼€å‘é˜¶æ®µ**
- [ ] é¡¹ç›®ç»“æ„åˆ›å»ºå®Œæˆ
- [ ] å¼€å‘ç¯å¢ƒæ­å»ºå®Œæˆ
- [ ] æ•°æ®åº“è®¾è®¡å’Œè¿ç§»å®Œæˆ
- [ ] JWTè®¤è¯ç³»ç»Ÿå®ç°
- [ ] æ ¸å¿ƒAPIç«¯ç‚¹å¼€å‘å®Œæˆ
- [ ] AIæœåŠ¡é›†æˆå®Œæˆ
- [ ] å‰ç«¯åŸºç¡€æ¶æ„æ­å»º
- [ ] ä¸»è¦é¡µé¢åŠŸèƒ½å®ç°
- [ ] ç®¡ç†å‘˜åŠŸèƒ½å¼€å‘

### **æµ‹è¯•é˜¶æ®µ**
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- [ ] APIé›†æˆæµ‹è¯•é€šè¿‡
- [ ] å‰ç«¯ç»„ä»¶æµ‹è¯•å®Œæˆ
- [ ] å®‰å…¨æ€§æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡
- [ ] ç”¨æˆ·æ¥å—æµ‹è¯•å®Œæˆ

### **éƒ¨ç½²é˜¶æ®µ**
- [ ] ç”Ÿäº§ç¯å¢ƒé…ç½®å®Œæˆ
- [ ] Dockeré•œåƒæ„å»ºæˆåŠŸ
- [ ] æ•°æ®åº“è¿ç§»å®Œæˆ
- [ ] SSLè¯ä¹¦é…ç½®å®Œæˆ
- [ ] ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿé…ç½®
- [ ] å¤‡ä»½ç­–ç•¥å®æ–½
- [ ] æ–‡æ¡£ç¼–å†™å®Œæˆ

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

### **æŠ€æœ¯æŒ‡æ ‡**
- **å“åº”æ—¶é—´**: APIå¹³å‡å“åº”æ—¶é—´ < 500ms
- **å¯ç”¨æ€§**: ç³»ç»Ÿå¯ç”¨ç‡ > 99.9%
- **æ€§èƒ½**: å¹¶å‘ç”¨æˆ·æ”¯æŒ > 1000
- **å®‰å…¨**: æ— é‡å¤§å®‰å…¨æ¼æ´

### **ç”¨æˆ·ä½“éªŒæŒ‡æ ‡**
- **åŠ è½½é€Ÿåº¦**: é¡µé¢é¦–å±åŠ è½½ < 2ç§’
- **æˆåŠŸç‡**: AIè¯†åˆ«å‡†ç¡®ç‡ > 85%
- **ç”¨æˆ·æ»¡æ„åº¦**: ç”¨æˆ·è¯„åˆ† > 4.5/5
- **è½¬åŒ–ç‡**: æ³¨å†Œè½¬åŒ–ç‡ > 15%

### **ä¸šåŠ¡æŒ‡æ ‡**
- **ç”¨æˆ·å¢é•¿**: æœˆæ´»è·ƒç”¨æˆ·å¢é•¿ç‡ > 20%
- **ä½¿ç”¨é¢‘ç‡**: æ—¥å‡ä½¿ç”¨æ¬¡æ•° > 2æ¬¡
- **åŠŸèƒ½é‡‡ç”¨ç‡**: æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨ç‡ > 60%
- **ç”¨æˆ·ç•™å­˜**: 30å¤©ç”¨æˆ·ç•™å­˜ç‡ > 40%

---

è¿™ä¸ªé¡¹ç›®è®¾è®¡æ–¹æ¡ˆæä¾›äº†ä¸€ä¸ªç°ä»£åŒ–ã€å¯æ‰©å±•ã€å®‰å…¨çš„DIYæ™ºèƒ½åŠ©æ‰‹å¹³å°æ¶æ„ã€‚é€šè¿‡åˆç†çš„æŠ€æœ¯é€‰æ‹©ã€æ¸…æ™°çš„æ¨¡å—åˆ’åˆ†å’Œè¯¦ç»†çš„å®æ–½è®¡åˆ’ï¼Œå¯ä»¥æ„å»ºå‡ºä¸€ä¸ªé«˜è´¨é‡çš„äº§å“ï¼Œæ»¡è¶³ç”¨æˆ·éœ€æ±‚å¹¶å…·å¤‡è‰¯å¥½çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚